<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             xmlns:vm="using:BillInsight.ViewModels"
             x:DataType="vm:AddInvoiceViewModel"
             x:Class="BillInsight.Views.AddInvoiceView">
    
    
    <UserControl.DataContext>
        <vm:AddInvoiceViewModel/>
    </UserControl.DataContext>
    
    
    <Grid ColumnDefinitions="3*,2*">
        <ScrollViewer Grid.Column="0">
        
            <StackPanel Margin="20" Spacing="16">

                <!-- ========== NBan Section ========== -->
                <Border Background="White" CornerRadius="8" Padding="16" BoxShadow="0 2 8 #AAA">
                    <StackPanel Spacing="8">
                        <TextBlock Text="---- NBan ----" FontSize="20" FontWeight="Bold" Foreground="#006400" />
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="CÔNG TY CỔ PHẦN THƯƠNG MẠI BÁCH HÓA XANH" FontWeight="Bold" />
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="MST: 0310471746" />
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Địa chỉ: 128 Trần Quang Khải, Phường Tân Định, Thành Phố Hồ Chí Minh, Việt Nam." />
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="ĐT: 19001908" />
                        
                        <Separator Margin="4"/>
                        <TextBlock Foreground="Black" Text="TTKhac:" FontWeight="Bold"/>
                        <StackPanel Spacing="2">
                            <TextBlock TextWrapping="Wrap" Foreground="Black" Text="loaiHD = HDonGTKT"/>
                            <TextBlock TextWrapping="Wrap" Foreground="Black" Text="nguoiBan = 225176 - Thái Thị Ngọc Vân"/>
                            <TextBlock TextWrapping="Wrap" Foreground="Black" Text="TDVi = CÔNG TY CỔ PHẦN THƯƠNG MẠI BÁCH HÓA XANH"/>
                            <TextBlock TextWrapping="Wrap" Foreground="Black" Text="diaChiCN = 26 Nguyễn Thượng Hiền, Phường Hạnh Thông, Thành phố Hồ Chí Minh, Việt Nam"/>
                            <TextBlock TextWrapping="Wrap" Foreground="Black" Text="TenCN = ĐỊA ĐIỂM KINH DOANH CÔNG TY CỔ PHẦN THƯƠNG MẠI BÁCH HÓA XANH - CỬA HÀNG BÁCH HÓA XANH SỐ 101"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- ========== HHDVu Section ========== -->
                <Border Background="White" CornerRadius="8" Padding="16" BoxShadow="0 2 8 #AAA">
                    <StackPanel>
                        <DockPanel>
                            <Button DockPanel.Dock="Right" 
                                    Classes="add-button"
                                    Padding="6,2"
                                    Margin="10,0,0,0"
                                    Command="{Binding AddProductCommand}"
                            >
                                <Svg  Path="{StaticResource AddLine}" Css=".fill { fill: #fff; } "
                                      Width="24" 
                                      Height="24" ></Svg>
                            </Button>
                            <TextBlock VerticalAlignment="Center" Text="---- HHDVu ----" FontSize="20" FontWeight="Bold" Foreground="#00008B" Margin="0,0,0,8"/>
                        </DockPanel>  
            
                        <StackPanel Margin="10" Spacing="8">

                            <!-- Header -->
                            <Grid ColumnDefinitions="*,150,50" Margin="0,0,0,8">
                                <TextBlock Foreground="Black" Text="Tên sản phẩm" FontWeight="Bold" Grid.Column="0"/>
                                <TextBlock Foreground="Black" Text="Giá (VNĐ)" FontWeight="Bold" Grid.Column="1" Margin="10,0,0,0"/>
                                <TextBlock Foreground="Black" Text="" FontWeight="Bold" Grid.Column="2" Margin="10,0,0,0"/>
                            </Grid>

                            <!-- Danh sách sản phẩm -->
                            <ItemsControl ItemsSource="{Binding Products}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Grid ColumnDefinitions="*,150,50" Margin="0,4,0,4">
                                            <!-- Tên sản phẩm -->
                                            <TextBox Text="{Binding Name, Mode=TwoWay}" Grid.Column="0"/>

                                            <!-- Giá -->
                                            <TextBox Text="{Binding Price, Mode=TwoWay}" Grid.Column="1" Margin="10,0,0,0"  HorizontalAlignment="Stretch"/>

                                            <!-- Nút Xóa -->
                                            <Button Classes="remove-button"
                                                    Margin="10,0,0,0"
                                                    Grid.Column="2"
                                                    Command="{Binding $parent[ItemsControl].((vm:AddInvoiceViewModel)DataContext).RemoveProductCommand}"
                                                    CommandParameter="{Binding Id}"
                                                    >
                                                <Svg  Path="{StaticResource XCircleIcon}" Css=".fill { fill: #fff; } "
                                                     Width="24" 
                                                     Height="24" ></Svg>
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <StackPanel>
                                <TextBlock Text="Nhập Captcha"
                                           FontSize="16"
                                           Foreground="#333" />
                                <TextBox />
                                
                                <Button Classes="remove-button" Background="#166534" 
                                        Margin="0,10,0,0">
                                    <Svg Path="{StaticResource Save}" Css=".fill { fill: #4ade80; } "
                                          Width="24" 
                                          Height="24" ></Svg>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- ========== TToan Section ========== -->
                <Border Background="White" CornerRadius="8" Padding="16" BoxShadow="0 2 8 #AAA">
                    <StackPanel Spacing="4">
                        <TextBlock Text="---- TToan ----" FontSize="20" FontWeight="Bold" Foreground="#8B0000"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Thuế suất: 5%, Tiền: 22606, Thuế: 1130"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Thuế suất: 8%, Tiền: 39537, Thuế: 3163"/>
                        <Separator Margin="4"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Tổng cộng chưa thuế: 62143" FontWeight="Bold"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Tiền thuế: 4293"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Tổng thanh toán (số): 66436" FontWeight="Bold"/>
                        <TextBlock TextWrapping="Wrap" Foreground="Black" Text="Tổng thanh toán (chữ): Sáu mươi sáu nghìn bốn trăm ba mươi sáu đồng chẵn" FontStyle="Italic"/>
                    </StackPanel>
                </Border>
            </StackPanel>
                
        </ScrollViewer>
        
        <ScrollViewer Grid.Column="1">
            <StackPanel
                Width="400"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Spacing="15">

                <!-- Thẻ chứa toàn bộ khung -->
                <Border Background="#FFF"
                        CornerRadius="12"
                        BoxShadow="0 4 12 #00000030"
                        Padding="20"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel Spacing="5" HorizontalAlignment="Center">

                        <!-- Tiêu đề -->
                        <TextBlock Text="Chọn ảnh hóa đơn"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="#333"
                                   HorizontalAlignment="Center"/>

                        <!-- Khu vực xem trước ảnh -->
                        <Border Background="#F8F8F8"
                                BorderBrush="#DDD"
                                BorderThickness="1"
                                CornerRadius="10"
                                Padding="5"
                                HorizontalAlignment="Center">
                            <Image x:Name="PreviewImage"
                                   Source="{Binding ImageSource}"
                                   Width="280" Height="280"
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"/>
                        </Border>

                        <!-- Đường dẫn -->
                        <TextBlock Text="{Binding FilePath}"
                                   FontSize="13"
                                   Foreground="#555"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"/>

                        <!-- Các nút thao tác -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Center"
                                    Spacing="10">
                            <Button Classes="add-pic-button"
                                    Padding="8,4"
                                    CornerRadius="8"
                                    Width="50"
                                    Click="OpenFileButton_Clicked">
                                <Svg Path="{StaticResource Picture}" 
                                     Width="24" Height="24"
                                     Css=".fill { fill: #fcd34d; }"></Svg>
                            </Button>

                            <Button Classes="remove-button"
                                    Padding="8,4"
                                    CornerRadius="8"
                                    Width="50"
                                    Command="{Binding RemoveImageCommand}"
                            >
                                <Svg Path="{StaticResource Delete}" 
                                     Width="24" Height="24"
                                     Css=".fill { fill: #fcd34d; }"></Svg>
                            </Button>
                            
                            <Button Classes="send-button"
                                    Padding="8,4"
                                    CornerRadius="8"
                                    Width="50"
                            >
                                <Svg Path="{StaticResource Send}" 
                                     Width="24" Height="24"
                                     Css=".fill { fill: #fcd34d; }"></Svg>
                            </Button>
                        </StackPanel>
                        
                        <!-- Captcha -->
                        <TextBlock Text="Captcha"
                                   FontSize="20"
                                   FontWeight="SemiBold"
                                   Foreground="#333"
                                   HorizontalAlignment="Center"/>

                        <Border Background="#F8F8F8"
                                BorderBrush="#DDD"
                                BorderThickness="1"
                                CornerRadius="10"
                                Padding="5"
                                HorizontalAlignment="Center">
                            <Image 
                                   Source="{Binding ImageSource}"
                                   Width="280" Height="100"
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"/>
                        </Border>
                        
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
